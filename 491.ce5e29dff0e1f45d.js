"use strict";(self.webpackChunkpersonal_web=self.webpackChunkpersonal_web||[]).push([[491],{7491:(Lt,U,s)=>{s.r(U),s.d(U,{MountsModule:()=>St});var D=s(529),l=s(4006),z=s(5180),R=s(2694),V=s(5106),H=s(9605),G=s(6333),P=s(8553),W=s(3631),x=s(5593),J=s(585),X=s(4247),K=s(2137),y=s(1493),w=s(2210),k=s(7913),Y=s(1740),Q=s(3054),q=s(2665),_=s(5722),tt=s(1765),I=s(8783),et=s(2453),M=s(5721),nt=s(4121),F=s(4450),B=s(9300),c=s(5861),m=s(4188),N=s(2651),ot=s(783),d=s(8954);class f extends ot.x{constructor(){super(d.I.upperCamelCase.singular)}static getInstance(){return f.instance||(f.instance=new f),f.instance}}const u=f.getInstance();var st=s(7379),at=s(91);const it={...st.f},rt=[];class h extends at.E{constructor(){super(d.I.kebabCase.plural.normal,u,it,rt)}static getInstance(){return h.instance||(h.instance=new h),h.instance}}const p=h.getInstance();var t=s(4650),A=s(2997),Z=s(805),T=s(3416),v=s(6895);const lt=["createImagenesForm"],ut=["updateImagenesForm"];function ct(n,r){1&n&&(t.TgZ(0,"div",17),t._UZ(1,"i",18),t.qZA())}function mt(n,r){if(1&n&&(t.TgZ(0,"small",19),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errores.user," ")}}function dt(n,r){if(1&n&&(t.TgZ(0,"small",19),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errores.date," ")}}function pt(n,r){if(1&n&&(t.TgZ(0,"small",19),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errores.description," ")}}function gt(n,r){if(1&n&&(t.TgZ(0,"small",19),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.errores.video," ")}}function ft(n,r){if(1&n&&(t.TgZ(0,"small",19),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.errores.video," ")}}function ht(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"div",20)(2,"span",7),t._UZ(3,"input",21),t.TgZ(4,"label"),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.YNc(7,ft,2,1,"small",9),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(5),t.hij("",t.lcZ(6,2,"columns.video")," *"),t.xp6(2),t.Q6J("ngIf",!e.form.controls.video.valid)}}const j=function(n){return{name:n}};function vt(n,r){if(1&n&&(t._UZ(0,"button",22),t.ALo(1,"translate"),t.ALo(2,"translate")),2&n){const e=t.oxw();t.Q6J("label",t.xi3(1,1,"buttons.create",t.VKq(6,j,t.lcZ(2,4,"tables."+e.names.camelCase.singular+".singular"))))}}function bt(n,r){if(1&n&&(t._UZ(0,"button",22),t.ALo(1,"translate"),t.ALo(2,"translate")),2&n){const e=t.oxw();t.Q6J("label",t.xi3(1,1,"buttons.update",t.VKq(6,j,t.lcZ(2,4,"tables."+e.names.camelCase.singular+".singular"))))}}const Ct=function(){return{width:"100%",maxWidth:"40rem"}},S=function(n,r){return{"ng-invalid":n,"ng-dirty":r}};let $=(()=>{class n{constructor(e,o,a,i,b,C,L,Et){this.formBuilder=e,this.mountstore=o,this.toastSrv=a,this.translateSrv=i,this.config=b,this.route=C,this.router=L,this.toastUtils=Et,this.visible=!1,this.mount$=this.mountstore.select(p.getOne),this.loading$=this.mountstore.select(p.getLoading),this.message$=this.mountstore.select(p.getMessage).pipe((0,B.h)(g=>!!g)),this.names=d.I,this.errores=[],this.componentsForm=this.formBuilder.array([]),this.imagesForm=this.formBuilder.array([]),this.subscriptions=[],i.setDefaultLang("es"),this.route.params.subscribe(g=>{if(this.id=Number(g.id),g.modalMode){switch(g.modalMode){case"VIEW":default:this.show(m.g.VIEW);break;case"UPDATE":this.show(m.g.UPDATE);break;case"CREATE":this.show(m.g.CREATE)}"CREATE"!==g.modalMode&&this.mountstore.dispatch(u.loadOne({id:Number(g.id)}))}})}get components(){return this.form.controls.components.value}get images(){return this.form.controls.images.value}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}ngOnInit(){var e=this;this.form=this.formBuilder.group({id:[Date.now()],user:[void 0,[l.kI.required]],video:[void 0],description:[void 0,[l.kI.required]],date:[new Date,[l.kI.required]],components:[[],[l.kI.required]],images:this.imagesForm});const o=this.mount$.subscribe(i=>{this.patchValue(i)});this.subscriptions.push(o);const a=this.message$.subscribe(function(){var i=(0,c.Z)(function*(b){const C=yield e.toastUtils.messageHandler(e.names.camelCase.singular,N.C.HIDE_MODAL,b);null!==C&&(e.visible=C)});return function(b){return i.apply(this,arguments)}}());this.subscriptions.push(a)}translate(e){this.translateSrv.use(e),this.translateSrv.get("calendar").subscribe(o=>this.config.setTranslation(o))}send(){if(Object.values(this.form.controls).forEach(e=>{e.markAsDirty()}),!this.form.invalid)switch(this.modalMode){case m.g.CREATE:this.mountstore.dispatch(u.create({payload:this.form.value}));break;case m.g.UPDATE:this.mountstore.dispatch(u.update({payload:this.form.value}))}}show(e){this.patchValue(null),this.modalMode=e,e==m.g.CREATE&&this.mountstore.dispatch(u.unload()),this.visible=!0}onHide(){this.visible=!1,this.errores=[],this.mountstore.dispatch(u.unload()),this.form.reset(),this.createImagenesForm?.reset(),this.updateImagenesForm?.reset(),this.router.navigate(["backoffice",d.I.kebabCase.plural.normal])}patchValue(e){this.form&&this.form.patchValue(e?{id:e.id,description:e.description,date:e.date,user:e.user,video:e.video,components:e.components,images:e.images}:{id:Date.now(),description:void 0,date:new Date,user:void 0,video:void 0,components:[],images:[]})}addComponent(e){this.components.push(e)}deleteComponent(e){}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.qu),t.Y36(A.yh),t.Y36(Z.ez),t.Y36(T.sK),t.Y36(Z.b4),t.Y36(M.gz),t.Y36(M.F0),t.Y36(N.z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-mount-modal"]],viewQuery:function(e,o){if(1&e&&(t.Gf(lt,5),t.Gf(ut,5)),2&e){let a;t.iGM(a=t.CRH())&&(o.createImagenesForm=a.first),t.iGM(a=t.CRH())&&(o.updateImagenesForm=a.first)}},decls:42,vars:47,consts:[[3,"draggable","resizable","modal","maximizable","visible","visibleChange","onHide"],["class","loading-modal p-component-overlay",4,"ngIf"],[3,"header"],[1,"grid","p-fluid"],[1,"col-12","p-3",3,"formGroup","ngSubmit"],[1,"grid"],[1,"xs:col-12","lg:col-6"],[1,"p-float-label"],["type","text","formControlName","user","pInputText","",1,"p-inputtext-sm",3,"ngClass"],["class","p-error",4,"ngIf"],["formControlName","date","appendTo","body",1,"p-inputtext-sm",3,"showIcon"],[1,"xs:col-12","lg:col-12"],["formControlName","description","pInputTextarea","",1,"p-inputtext-sm",3,"ngClass"],["type","text","formControlName","video","pInputText","",1,"p-inputtext-sm",3,"ngClass"],[4,"ngFor","ngForOf"],[1,"button-container","my-3"],["pButton","","type","submit",3,"label",4,"ngIf"],[1,"loading-modal","p-component-overlay"],[1,"pi","pi-spin","pi-spinner"],[1,"p-error"],[1,"col-12"],["type","text","formControlName","video","pInputText","",1,"p-inputtext-sm"],["pButton","","type","submit",3,"label"]],template:function(e,o){1&e&&(t.TgZ(0,"p-dialog",0),t.NdJ("visibleChange",function(i){return o.visible=i})("onHide",function(){return o.onHide()}),t.YNc(1,ct,2,0,"div",1),t.ALo(2,"async"),t.TgZ(3,"p-tabView")(4,"p-tabPanel",2),t.ALo(5,"translate"),t.TgZ(6,"div",3)(7,"form",4),t.NdJ("ngSubmit",function(){return o.send()}),t.TgZ(8,"div",5)(9,"div",6)(10,"span",7),t._UZ(11,"input",8),t.TgZ(12,"label"),t._uU(13),t.ALo(14,"translate"),t.qZA()(),t.YNc(15,mt,2,1,"small",9),t.qZA(),t.TgZ(16,"div",6)(17,"span",7),t._UZ(18,"p-calendar",10),t.TgZ(19,"label"),t._uU(20),t.ALo(21,"translate"),t.qZA()(),t.YNc(22,dt,2,1,"small",9),t.qZA(),t.TgZ(23,"div",11)(24,"span",7),t._UZ(25,"textarea",12),t.TgZ(26,"label"),t._uU(27),t.ALo(28,"translate"),t.qZA()(),t.YNc(29,pt,2,1,"small",9),t.qZA(),t.TgZ(30,"div",6)(31,"span",7),t._UZ(32,"input",13),t.TgZ(33,"label"),t._uU(34),t.ALo(35,"translate"),t.qZA()(),t.YNc(36,gt,2,1,"small",9),t.qZA(),t.ynx(37),t.YNc(38,ht,8,4,"ng-container",14),t.BQk(),t.qZA(),t.TgZ(39,"div",15),t.YNc(40,vt,3,8,"button",16),t.YNc(41,bt,3,8,"button",16),t.qZA()()()()()()),2&e&&(t.Akn(t.DdM(37,Ct)),t.Q6J("draggable",!1)("resizable",!1)("modal",!0)("maximizable",!0)("visible",o.visible),t.xp6(1),t.Q6J("ngIf",t.lcZ(2,25,o.loading$)),t.xp6(3),t.s9C("header",t.lcZ(5,27,"tabs.info")),t.xp6(3),t.Q6J("formGroup",o.form),t.xp6(4),t.Q6J("ngClass",t.WLB(38,S,o.form.controls.user.invalid,o.form.controls.user.dirty)),t.xp6(2),t.hij("",t.lcZ(14,29,"columns.user")," *"),t.xp6(2),t.Q6J("ngIf",!o.form.controls.user.valid),t.xp6(3),t.Q6J("showIcon",!0),t.xp6(2),t.hij("",t.lcZ(21,31,"columns.date")," *"),t.xp6(2),t.Q6J("ngIf",!o.form.controls.date.valid),t.xp6(3),t.Q6J("ngClass",t.WLB(41,S,o.form.controls.description.invalid,o.form.controls.description.dirty)),t.xp6(2),t.hij("",t.lcZ(28,33,"columns.description")," *"),t.xp6(2),t.Q6J("ngIf",!o.form.controls.description.valid),t.xp6(3),t.Q6J("ngClass",t.WLB(44,S,o.form.controls.video.invalid,o.form.controls.video.dirty)),t.xp6(2),t.hij("",t.lcZ(35,35,"columns.video")," *"),t.xp6(2),t.Q6J("ngIf",!o.form.controls.video.valid),t.xp6(2),t.Q6J("ngForOf",o.components),t.xp6(2),t.Q6J("ngIf","create"===o.modalMode),t.xp6(1),t.Q6J("ngIf","update"===o.modalMode))},dependencies:[v.mk,v.sg,v.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,x.Hq,y.V,J.f,Y.o,Q.g,I.xf,I.x4,v.Ov,T.X$]}),n})();var Mt=s(5482);let E=(()=>{class n{constructor(e,o,a,i,b,C,L){this.store=e,this.confirmationSrv=o,this.messageSrv=a,this.toastSrv=i,this.router=b,this.translateSrv=C,this.publicLanguageStore=L,this.entities$=this.store.select(p.getAll),this.loading$=this.store.select(p.getLoading),this.count$=this.store.select(p.getCount),this.names=d.I,this.requestFilter=F.N.defaultRequestFilter,this.loadTable=!1,this.permisos=[]}ngOnInit(){this.publicLanguageStore.select(nt.$.getOne).pipe((0,B.h)(e=>null!=e)).subscribe(e=>{this.translateSrv.use(e.acronym)}),this.translateSrv.onLangChange.subscribe(e=>{this.cargarPagina()}),this.cargarPagina(),this.getAll()}getAll(){this.cargarPagina(),this.store.dispatch(u.loadAll({payload:this.requestFilter}))}onClick(e){switch(e.type){case"add":this.router.navigate(["backoffice",this.names.kebabCase.plural.normal,{modalMode:"CREATE"}]);break;case"view":this.router.navigate(["backoffice",this.names.kebabCase.plural.normal,{modalMode:"VIEW",id:e.data.id}]);break;case"edit":this.router.navigate(["backoffice",this.names.kebabCase.plural.normal,{modalMode:"UPDATE",id:e.data.id}]);break;case"delete":this.confirmationSrv.confirm({message:this.translateSrv.instant("messages.confirmation.message",{name:this.translateSrv.instant(`tables.${this.names.camelCase.singular}.singular`)}),header:this.translateSrv.instant("messages.confirmation.header"),icon:"pi pi-info-circle",rejectLabel:this.translateSrv.instant("buttons.reject"),acceptLabel:this.translateSrv.instant("buttons.accept"),accept:()=>{this.store.dispatch(u.delete({id:e.data.id}))}})}}cargarPagina(){let e=[],o=[];o.push({action:"add",icon:"pi pi-plus",label:this.translateSrv.instant("buttons.new",{name:this.translateSrv.instant("tables.mount.singular")})}),e.push({action:"view",icon:"pi pi-search-plus"}),e.push({action:"edit",icon:"pi pi-pencil"}),e.push({action:"delete",icon:"pi pi-trash"}),this.tableConfig={fieldConfig:[{field:"date",nombre:this.translateSrv.instant("columns.date"),sort:!1,filter:!1,tipo:"FECHA"},{field:"user",nombre:this.translateSrv.instant("columns.user"),sort:!1,filter:!1,tipo:"TEXTO"},{field:"description",nombre:this.translateSrv.instant("columns.description"),sort:!1,filter:!1,tipo:"TEXTO"}],optionButtons:e,topButtons:o}}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A.yh),t.Y36(Z.YP),t.Y36(Z.ez),t.Y36(Z.ez),t.Y36(M.F0),t.Y36(T.sK),t.Y36(A.yh))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-mount"]],viewQuery:function(e,o){if(1&e&&t.Gf($,5),2&e){let a;t.iGM(a=t.CRH())&&(o.modal=a.first)}},decls:11,vars:15,consts:[[1,"ui-g"],[1,"p-col-12"],[1,"card","card-w-title"],[3,"entities","loading","totalRecords","permisos","tableConfig","requestFilter","requestFilterChange","loadAll","onButtonClick"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"app-tabla-generica",3),t.NdJ("requestFilterChange",function(i){return o.requestFilter=i})("loadAll",function(){return o.getAll()})("onButtonClick",function(i){return o.onClick(i)}),t.ALo(7,"async"),t.ALo(8,"async"),t.ALo(9,"async"),t.qZA()()()(),t._UZ(10,"app-mount-modal")),2&e&&(t.xp6(4),t.hij(" ",t.lcZ(5,7,"tables."+o.names.camelCase.singular+".plural")," "),t.xp6(2),t.Q6J("entities",t.lcZ(7,9,o.entities$))("loading",t.lcZ(8,11,o.loading$))("totalRecords",t.lcZ(9,13,o.count$))("permisos",o.permisos)("tableConfig",o.tableConfig)("requestFilter",o.requestFilter))},dependencies:[Mt.w,$,v.Ov,T.X$]}),n})();const Zt=[{path:"",component:E,canActivate:[],pathMatch:"full"},{path:"modal/:modalMode",component:E,canActivate:[]},{path:"modal/:modalMode/:id",component:E,canActivate:[]}];let At=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[M.Bz.forChild(Zt),M.Bz]}),n})();var O=s(8776),Tt=s(2307),xt=s(3187);let yt=(()=>{class n{constructor(){this._session=null,this.table=d.I.snakeCase.plural.normal,this.supabase=(0,xt.eI)(F.N.apiUrl,F.N.apiKey)}getAll(e){var o=this;return(0,c.Z)(function*(){let{data:a,error:i}=yield o.supabase.from(o.table).select("*");return i||a})()}getOne(e){var o=this;return(0,c.Z)(function*(){let{data:a,error:i}=yield o.supabase.from(o.table).select("*").match({id:e}).single();return i||a})()}create(e){var o=this;return(0,c.Z)(function*(){let{data:a,error:i}=yield o.supabase.from(o.table).insert([e]);return i||a})()}update(e){var o=this;return(0,c.Z)(function*(){let{data:a,error:i}=yield o.supabase.from(o.table).update(e).eq("id",e.id);return i||a})()}delete(e){var o=this;return(0,c.Z)(function*(){let{data:a,error:i}=yield o.supabase.from(o.table).delete().eq("id",e);return i||a})()}count(){var e=this;return(0,c.Z)(function*(){let{data:o,error:a}=yield e.supabase.from(e.table).select("*",{count:"exact"});return a||o})()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),It=(()=>{class n extends Tt.P{constructor(e,o){super(e,u,o),this.actions$=e,this.mountSrv=o}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(O.eX),t.LFG(yt))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),Ft=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[v.ez,O.sQ.forFeature([It]),A.Aw.forFeature(d.I.kebabCase.plural.normal,p.reducer)]}),n})(),St=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[V.S,At,D.JF,l.u5,l.UX,z.$,et.EV,x.hJ,q.O,y.S,tt.U$,X.d,K.D,W.WN,x.hJ,J._8,y.S,w.kW,Y.j,k.Iu,Q.A,I.LU,_.q4,H.y,P.I,Ft,R.t,G.D]}),n})()}}]);