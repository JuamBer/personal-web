"use strict";(self.webpackChunkpersonal_web=self.webpackChunkpersonal_web||[]).push([[511],{6748:(N,T,a)=>{a.r(T),a.d(T,{PositionsModule:()=>ht});var d=a(7204),p=a(2694),f=a(2983),r=a(9605),j=a(5433),s=a(8553),i=a(5636),l=a(550),c=a(7618),g=a(4121),b=a(4450),R=a(9300),L=a(8217),V=a(5861),v=a(4006),A=a(4188),B=a(2651),H=a(3088),w=a(2616),_=a(609),C=a(6326),J=a(2242),Z=a(9687),t=a(4650),E=a(2997),S=a(805),M=a(3416),U=a(6895),K=a(585),k=a(5593),X=a(1740),z=a(2210),G=a(3054),Q=a(8783),q=a(1493);function tt(o,m){1&o&&(t.TgZ(0,"div",17),t._UZ(1,"i",18),t.qZA())}function et(o,m){if(1&o&&(t.TgZ(0,"small",19),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.errores.name," ")}}function ot(o,m){if(1&o&&(t.TgZ(0,"small",19),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.errores.company," ")}}function at(o,m){if(1&o&&(t.TgZ(0,"small",19),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.errores.description," ")}}function nt(o,m){if(1&o&&(t.TgZ(0,"small",19),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.errores.dateFrom," ")}}function st(o,m){if(1&o&&(t.TgZ(0,"small",19),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.errores.dateTo," ")}}const $=function(o){return{name:o}};function it(o,m){if(1&o&&(t._UZ(0,"button",20),t.ALo(1,"translate"),t.ALo(2,"translate")),2&o){const e=t.oxw();t.Q6J("label",t.xi3(1,1,"buttons.create",t.VKq(6,$,t.lcZ(2,4,"tables."+e.names.camelCase.singular+".singular"))))}}function rt(o,m){if(1&o&&(t._UZ(0,"button",20),t.ALo(1,"translate"),t.ALo(2,"translate")),2&o){const e=t.oxw();t.Q6J("label",t.xi3(1,1,"buttons.update",t.VKq(6,$,t.lcZ(2,4,"tables."+e.names.camelCase.singular+".singular"))))}}const lt=function(){return{width:"100%",maxWidth:"40rem"}},F=function(o,m){return{"ng-invalid":o,"ng-dirty":m}};let W=(()=>{class o{constructor(e,n,u,h,I,P,x,D,Y,ft,gt){this.store=e,this.companyStore=n,this.toastSrv=u,this.formBuilder=h,this.router=I,this.accountStore=P,this.translateSrv=x,this.confirmationSrv=D,this.messageSrv=Y,this.route=ft,this.toastUtils=gt,this.visible=!1,this.loading$=this.store.select(Z.Y.getLoading),this.position$=this.store.select(Z.Y.getOne),this.message$=this.store.select(Z.Y.getMessage).pipe((0,R.h)(y=>!!y)),this.names=J.p,this.companyNames=L.t,this.companies$=this.companyStore.select(_.K.getAll),this.errores=[],this.prepared=!1,this.submitB=!1,this.subscriptions=[],this.route.params.subscribe(y=>{if(y.modalMode){switch(y.modalMode){case"VIEW":default:this.show(A.g.VIEW);break;case"UPDATE":this.show(A.g.UPDATE);break;case"CREATE":this.show(A.g.CREATE)}"CREATE"!==y.modalMode&&this.store.dispatch(C.y.loadOne({id:Number(y.id)}))}})}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}ngOnInit(){var e=this;this.form=this.formBuilder.group({id:[Date.now(),[v.kI.required]],name:[void 0,[v.kI.required]],description:[void 0,[v.kI.required]],company:[void 0,[v.kI.required]],dateFrom:[new Date,[v.kI.required]],dateTo:[new Date]});const n=this.position$.subscribe(h=>{this.patchValue(h)});this.subscriptions.push(n),this.companyStore.dispatch(w._.loadAll({payload:null}));const u=this.message$.subscribe(function(){var h=(0,V.Z)(function*(I){const P=yield e.toastUtils.messageHandler(e.names.camelCase.singular,B.C.HIDE_MODAL,I);null!==P&&(e.visible=P)});return function(I){return h.apply(this,arguments)}}());this.subscriptions.push(u)}translate(e){this.translateSrv.use(e)}show(e){this.patchValue(null),this.modalMode=e,this.form?.enable(),e==A.g.CREATE&&this.store.dispatch(C.y.unload()),e==A.g.VIEW&&this.form?.disable(),this.visible=!0}onHide(){this.visible=!1,this.errores=[],this.store.dispatch(C.y.unload()),this.form.reset(),this.submitB=!1,this.router.navigate(["backoffice",this.names.kebabCase.plural.normal])}patchValue(e){this.form&&this.form.patchValue(e?{id:e.id,name:e.name,description:e.description,company:e.company,dateFrom:new Date(e.dateFrom),dateTo:new Date(e.dateTo)}:{id:Date.now(),name:void 0,description:void 0,company:void 0,dateFrom:new Date,dateTo:new Date})}send(){if(this.submitB=!0,Object.values(this.form.controls).forEach(e=>{e.markAsDirty()}),this.form.invalid){this.toastSrv.add({severity:"warn",summary:"Error",detail:this.translateSrv.instant("user.modal.invalid")});let e=this.translateSrv.instant("position.modal.error");for(let n in this.form.controls){let u=this.form.controls[n],h=this.translateSrv.instant("columns."+n);(u.invalid&&""==u.value||u.invalid&&null==u.value)&&(this.errores[n]=e+h)}}else switch(this.modalMode){case A.g.CREATE:this.store.dispatch(C.y.create({payload:this.form.value}));break;case A.g.UPDATE:this.store.dispatch(C.y.update({payload:this.form.value}))}}calculateMaxWidth(e){return H.c.calculateMaxWidth(e)}get ModalMode(){return A.g}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(E.yh),t.Y36(E.yh),t.Y36(S.ez),t.Y36(v.qu),t.Y36(l.F0),t.Y36(E.yh),t.Y36(M.sK),t.Y36(S.YP),t.Y36(S.ez),t.Y36(l.gz),t.Y36(B.z))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-position-modal"]],decls:48,vars:52,consts:[[3,"draggable","resizable","modal","maximizable","visible","visibleChange","onHide"],["class","loading-modal p-component-overlay",4,"ngIf"],[3,"header"],[1,"grid","p-fluid"],[1,"col-12","p-3",3,"formGroup","ngSubmit"],[1,"grid"],[1,"xs:col-12","lg:col-6"],[1,"p-float-label"],["type","text","formControlName","name","pInputText","",1,"p-inputtext-sm",3,"ngClass"],["class","p-error",4,"ngIf"],["formControlName","company","optionLabel","name","filterBy","name","appendTo","body",1,"p-inputtext-sm",3,"autoDisplayFirst","options","filter"],[1,"xs:col-12","lg:col-12"],["formControlName","description","pInputTextarea","",1,"p-inputtext-sm",3,"ngClass"],["formControlName","dateFrom","appendTo","body",1,"p-inputtext-sm",3,"showIcon"],["formControlName","dateTo","appendTo","body",1,"p-inputtext-sm",3,"showIcon"],[1,"button-container","my-3"],["pButton","","type","submit",3,"label",4,"ngIf"],[1,"loading-modal","p-component-overlay"],[1,"pi","pi-spin","pi-spinner"],[1,"p-error"],["pButton","","type","submit",3,"label"]],template:function(e,n){1&e&&(t.TgZ(0,"p-dialog",0),t.NdJ("visibleChange",function(h){return n.visible=h})("onHide",function(){return n.onHide()}),t.YNc(1,tt,2,0,"div",1),t.ALo(2,"async"),t.TgZ(3,"p-tabView")(4,"p-tabPanel",2),t.ALo(5,"translate"),t.TgZ(6,"div",3)(7,"form",4),t.NdJ("ngSubmit",function(){return n.send()}),t.TgZ(8,"div",5)(9,"div",6)(10,"span",7),t._UZ(11,"input",8),t.TgZ(12,"label"),t._uU(13),t.ALo(14,"translate"),t.qZA()(),t.YNc(15,et,2,1,"small",9),t.qZA(),t.TgZ(16,"div",6)(17,"span",7),t._UZ(18,"p-dropdown",10),t.ALo(19,"async"),t.TgZ(20,"label"),t._uU(21),t.ALo(22,"translate"),t.qZA()(),t.YNc(23,ot,2,1,"small",9),t.qZA(),t.TgZ(24,"div",11)(25,"span",7),t._UZ(26,"textarea",12),t.TgZ(27,"label"),t._uU(28),t.ALo(29,"translate"),t.qZA()(),t.YNc(30,at,2,1,"small",9),t.qZA(),t.TgZ(31,"div",6)(32,"span",7),t._UZ(33,"p-calendar",13),t.TgZ(34,"label"),t._uU(35),t.ALo(36,"translate"),t.qZA()(),t.YNc(37,nt,2,1,"small",9),t.qZA(),t.TgZ(38,"div",6)(39,"span",7),t._UZ(40,"p-calendar",14),t.TgZ(41,"label"),t._uU(42),t.ALo(43,"translate"),t.qZA()(),t.YNc(44,st,2,1,"small",9),t.qZA()(),t.TgZ(45,"div",15),t.YNc(46,it,3,8,"button",16),t.YNc(47,rt,3,8,"button",16),t.qZA()()()()()()),2&e&&(t.Akn(t.DdM(45,lt)),t.Q6J("draggable",!1)("resizable",!1)("modal",!0)("maximizable",!0)("visible",n.visible),t.xp6(1),t.Q6J("ngIf",t.lcZ(2,29,n.loading$)),t.xp6(3),t.s9C("header",t.lcZ(5,31,"tabs.info")),t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(4),t.Q6J("ngClass",t.WLB(46,F,n.form.controls.name.invalid,n.form.controls.name.dirty)),t.xp6(2),t.hij("",t.lcZ(14,33,"columns.name")," *"),t.xp6(2),t.Q6J("ngIf",!n.form.controls.name.valid),t.xp6(3),t.Q6J("autoDisplayFirst",!1)("options",t.lcZ(19,35,n.companies$))("filter",!0),t.xp6(3),t.hij("",t.lcZ(22,37,"tables."+n.companyNames.camelCase.singular+".singular")," *"),t.xp6(2),t.Q6J("ngIf",!n.form.controls.company.valid),t.xp6(3),t.Q6J("ngClass",t.WLB(49,F,n.form.controls.description.invalid,n.form.controls.description.dirty)),t.xp6(2),t.hij("",t.lcZ(29,39,"columns.description")," *"),t.xp6(2),t.Q6J("ngIf",!n.form.controls.description.valid),t.xp6(3),t.Q6J("showIcon",!0),t.xp6(2),t.hij("",t.lcZ(36,41,"columns.dateFrom")," *"),t.xp6(2),t.Q6J("ngIf",!n.form.controls.dateFrom.valid),t.xp6(3),t.Q6J("showIcon",!0),t.xp6(2),t.Oqu(t.lcZ(43,43,"columns.dateTo")),t.xp6(2),t.Q6J("ngIf",!n.form.controls.dateTo.valid),t.xp6(2),t.Q6J("ngIf",n.modalMode===n.ModalMode.CREATE),t.xp6(1),t.Q6J("ngIf",n.modalMode===n.ModalMode.UPDATE))},dependencies:[U.mk,U.O5,v._Y,v.Fj,v.JJ,v.JL,v.sg,v.u,K.f,k.Hq,X.o,z.Lt,G.g,Q.xf,Q.x4,q.V,U.Ov,M.X$]}),o})();var ct=a(5482);const mt=function(){return[]};let O=(()=>{class o{constructor(e,n,u,h,I,P,x,D,Y){this.store=e,this.toastSrv=n,this.router=u,this.accountStore=h,this.translateSrv=I,this.confirmationSrv=P,this.messageSrv=x,this.publicLanguageStore=D,this.positionStore=Y,this.entities$=this.store.select(Z.Y.getAll),this.loading$=this.store.select(Z.Y.getLoading),this.count$=this.store.select(Z.Y.getCount),this.names=J.p,this.requestFilter=b.N.defaultRequestFilter,this.loadTable=!1}ngOnInit(){this.publicLanguageStore.select(g.$.getOne).pipe((0,R.h)(e=>null!=e)).subscribe(e=>{this.translateSrv.use(e.acronym)}),this.translateSrv.onLangChange.subscribe(e=>{this.cargarPagina()}),this.cargarPagina(),this.getAll()}cargarPagina(){let e=[],n=[];n.push({action:"add",icon:"pi pi-plus",label:this.translateSrv.instant("buttons.new",{name:this.translateSrv.instant(`tables.${this.names.camelCase.singular}.singular`)})}),e.push({action:"view",icon:"pi pi-search-plus"}),e.push({action:"edit",icon:"pi pi-pencil"}),e.push({action:"delete",icon:"pi pi-trash"}),this.tableConfig={fieldConfig:[{field:"name",nombre:this.translateSrv.instant("columns.name"),sort:!1,filter:!1,tipo:"TEXTO"},{field:"description",nombre:this.translateSrv.instant("columns.description"),sort:!1,filter:!1,tipo:"TEXTO"},{field:"company",nombre:this.translateSrv.instant(`tables.${L.t.camelCase.singular}.singular`),sort:!1,filter:!1,tipo:"OBJECTO",propiedadParaTipoObjecto:"name"},{field:"dateFrom",nombre:this.translateSrv.instant("columns.dateFrom"),sort:!1,filter:!1,tipo:"FECHA"},{field:"dateTo",nombre:this.translateSrv.instant("columns.dateTo"),sort:!1,filter:!1,tipo:"FECHA"}],optionButtons:e,topButtons:n}}getAll(){this.store.dispatch(C.y.loadAll({payload:this.requestFilter}))}onClick(e){switch(e.type){case"add":this.router.navigate(["backoffice",this.names.kebabCase.plural.normal,{modalMode:"CREATE"}]);break;case"view":this.router.navigate(["backoffice",this.names.camelCase.plural,{modalMode:"VIEW",id:e.data.id}]);break;case"edit":this.router.navigate(["backoffice",this.names.kebabCase.plural.normal,{modalMode:"UPDATE",id:e.data.id}]);break;case"delete":this.confirmationSrv.confirm({message:this.translateSrv.instant("messages.confirmation.message",{name:this.translateSrv.instant(`tables.${this.names.camelCase.singular}.singular`)}),header:this.translateSrv.instant("messages.confirmation.header"),icon:"pi pi-info-circle",rejectLabel:this.translateSrv.instant("buttons.reject"),acceptLabel:this.translateSrv.instant("buttons.accept"),accept:()=>{this.store.dispatch(C.y.delete({id:e.data.id}))}})}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(E.yh),t.Y36(S.ez),t.Y36(l.F0),t.Y36(E.yh),t.Y36(M.sK),t.Y36(S.YP),t.Y36(S.ez),t.Y36(E.yh),t.Y36(E.yh))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-position"]],viewQuery:function(e,n){if(1&e&&t.Gf(W,5),2&e){let u;t.iGM(u=t.CRH())&&(n.modal=u.first)}},decls:11,vars:16,consts:[[1,"ui-g"],[1,"p-col-12"],[1,"card","card-w-title"],[3,"entities","loading","totalRecords","permisos","tableConfig","requestFilter","requestFilterChange","loadAll","onButtonClick"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"app-tabla-generica",3),t.NdJ("requestFilterChange",function(h){return n.requestFilter=h})("loadAll",function(){return n.getAll()})("onButtonClick",function(h){return n.onClick(h)}),t.ALo(7,"async"),t.ALo(8,"async"),t.ALo(9,"async"),t.qZA()()()(),t._UZ(10,"app-position-modal")),2&e&&(t.xp6(4),t.hij(" ",t.lcZ(5,7,"tables."+n.names.camelCase.singular+".plural")," "),t.xp6(2),t.Q6J("entities",t.lcZ(7,9,n.entities$))("loading",t.lcZ(8,11,n.loading$))("totalRecords",t.lcZ(9,13,n.count$))("permisos",t.DdM(15,mt))("tableConfig",n.tableConfig)("requestFilter",n.requestFilter))},dependencies:[ct.w,W,U.Ov,M.X$]}),o})();const dt=[{path:"",component:O,canActivate:[c.a],pathMatch:"full"},{path:"modal/:modalMode",component:O,canActivate:[c.a]},{path:"modal/:modalMode/:id",component:O,canActivate:[c.a]}];let ut=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[l.Bz.forChild(dt),l.Bz]}),o})();var pt=a(9991);let ht=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[f.S,ut,j.g,p.t,d.X,p.t,r.y,pt.K,s.I,i.h]}),o})()},8426:(N,T,a)=>{a.d(T,{E7:()=>d,rE:()=>f,vA:()=>p});var d=(()=>{return(r=d||(d={})).TEXT="TEXT",r.NUMBER="NUMBER",r.DATE="DATE",r.TIME="TIME",r.DATETIME="DATETIME",r.CURRENCY="CURRENCY",r.OBJECT="OBJECT",r.ARRAY="ARRAY",r.BOOLEAN="BOOLEAN",r.IMAGE="IMAGE",d;var r})(),p=(()=>{return(r=p||(p={})).START_WITH="START_WITH",r.ENDS_WITH="ENDS_WITH",r.CONTAINS="CONTAINS",r.NOT_CONTAINS="NOT_CONTAINS",r.EQUAL="EQUAL",r.NOT_EQUAL="NOT_EQUAL",p;var r})(),f=(()=>{return(r=f||(f={})).CREATE="CREATE",r.UPDATE="UPDATE",r.DELETE="DELETE",r.VIEW="VIEW",r.DUPLICATE="DUPLICATE",f;var r})()},4188:(N,T,a)=>{a.d(T,{g:()=>d});var d=(()=>{return(p=d||(d={})).CREATE="CREATE",p.UPDATE="UPDATE",p.VIEW="VIEW",d;var p})()},62:(N,T,a)=>{a.d(T,{v:()=>r});var d=a(5861),p=a(8426),f=a(4642);class r{constructor(s,i,l="*",c="*",g="name"){this.supabase=s,this.table=i,this.getAllSelection=l,this.getOneSelection=c,this.titleSelection=g}getAll(s){var i=this;return(0,d.Z)(function*(){let l=i.supabase.from(i.table).select(i.getAllSelection);s&&"sortField"in s&&r.applyFiltersAndSorting(l,s);const{data:c,error:g}=yield l;return g||(0,f.iP)(c)})()}getTitle(s){var i=this;return(0,d.Z)(function*(){const{data:l,error:c}=yield i.supabase.from(i.table).select(i.titleSelection).match({id:s}).single();return c||(0,f.iP)(l)})()}getOne(s){var i=this;return(0,d.Z)(function*(){const{data:l,error:c}=yield i.supabase.from(i.table).select(i.getOneSelection).match({id:s}).single();return c||(0,f.iP)(l)})()}create(s){var i=this;return(0,d.Z)(function*(){const{data:l,error:c}=yield i.supabase.from(i.table).insert([(0,f.PI)((0,f.KU)(s))]);return c||l})()}update(s){var i=this;return(0,d.Z)(function*(){const{data:l,error:c}=yield i.supabase.from(i.table).update((0,f.PI)((0,f.KU)(s))).match({id:s.id});return c||l})()}delete(s){var i=this;return(0,d.Z)(function*(){const{data:l,error:c}=yield i.supabase.from(i.table).delete().match({id:s});return c||l})()}count(){var s=this;return(0,d.Z)(function*(){const{count:i,error:l}=yield s.supabase.from(s.table).select("*",{count:"exact",head:!0});return l||i})()}static applyFiltersAndSorting(s,i){i.sortField&&i.sortOrder&&(s=s.order(i.sortField,{ascending:1===i.sortOrder})),i.filters&&Object.entries(i.filters).forEach(([l,c])=>{const g=l,b=c.value.value;if(b)switch(c.value.filterType){case p.vA.START_WITH:s=s.ilike(g,`${b}%`);break;case p.vA.ENDS_WITH:s=s.ilike(g,`%${b}`);break;case p.vA.EQUAL:s=s.eq(g,b);break;case p.vA.NOT_EQUAL:s=s.not(g,"eq",b);break;case p.vA.CONTAINS:s=s.ilike(g,`%${b}%`);break;case p.vA.NOT_CONTAINS:s=s.not(g,"like",`%${b}%`);break;default:s=s.ilike(g,`%${b}%`)}}),Number.isInteger(i.first)&&Number.isInteger(i.rows)&&(s=s.range(i.first,i.first+i.rows-1))}}}}]);